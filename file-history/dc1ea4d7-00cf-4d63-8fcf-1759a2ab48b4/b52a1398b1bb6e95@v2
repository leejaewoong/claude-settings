# Sentiment-Curator 요구사항 명세서

## 1. 프로젝트 개요

**프로젝트명:** Sentiment-Curator
**목적:** PUBG 관련 커뮤니티(Reddit)의 유저 동향을 AI로 분석하여 사용자의 요구사항에 적합한 콘텐츠만을 엄선하여 Slack으로 전달하는 지능형 큐레이션 서비스

**주요 가치:**
- 방대한 커뮤니티 정보 중 관심사에 맞는 핵심 정보만 자동 선별
- 주기적 모니터링으로 트렌드를 놓치지 않음
- Slack 통합으로 팀 협업 및 정보 공유 용이

## 2. 핵심 기능 요구사항

### 2.1 데이터 수집 (Reddit Crawling)

**대상 플랫폼:**
- Reddit (r/PUBATTLEGROUNDS 및 설정 가능한 추가 서브레딧)

**수집 항목:**
- 포스트 제목
- 포스트 본문 (텍스트)
- 첨부 이미지 URL
- 댓글 전체 (스레드 구조 포함)
- 원본 링크 (permalink)
- 메타데이터 (작성 시간, 작성자, upvotes, awards 등)

**수집 범위:**
- 설정 가능한 시간 범위 (기본: 24시간 이내 작성된 콘텐츠)
- 서브레딧별 최신 포스트 우선

**데이터 관리:**
- 48시간 경과 시 자동 삭제 (DB 용량 최적화)
- 중복 포스트 방지 (Reddit Post ID 기반)

**기술적 요구사항:**
- Reddit API (PRAW) 사용
- Rate Limit 준수 (60 requests/minute)
- 비동기 크롤링으로 성능 최적화

### 2.2 AI 기반 콘텐츠 분석 및 선별

**선별 방식: 프롬프트 기반 필터링**
- 사용자가 자연어로 관심사 정의
  - 예시: "신규 패치 관련 버그 리포트와 밸런스 논의만"
  - 예시: "프로 선수들의 플레이 팁과 메타 분석"

**분석 대상:**
- 포스트 본문 + 댓글 전체 내용
- 포스트의 인기도 (upvotes, 댓글 수) 고려 가능

**AI 처리 로직:**
1. 포스트 + 댓글을 하나의 컨텍스트로 결합
2. 사용자 프롬프트와 의미적 유사도 판단 (LLM)
3. 관련도 점수 기반 상위 N개 선별

**관련 포스트 추천:**
- AI가 선별한 포스트와 유사한 내용의 다른 포스트 찾기
- 임베딩 기반 유사도 계산 (OpenAI Embeddings)
- 최대 3개까지 링크 추가

**AI 모델:**
- 주 모델: OpenAI GPT-4.1-2025-04-14
- 임베딩: OpenAI text-embedding-3-small

### 2.3 Slack 알림

**전달 형식: 포스트별 개별 메시지**
- 각 선별된 포스트마다 독립적인 Slack 메시지 전송
- 메시지 구조:
  ```
  [AI 요약]
  한국어로 번역된 핵심 요약 (2-3줄)

  📎 원본 링크: [Reddit 링크]
  🔗 관련 포스트:
    - [관련 포스트 1]
    - [관련 포스트 2]
  ```

**자동 번역:**
- 영어 포스트 → 한국어 자동 번역 (GPT 활용)
- 한국어 포스트는 그대로 요약

**Slack 기능 활용:**
- Unfurl 비활성화 (깔끔한 포맷 유지)
- Block Kit 사용 (구조화된 메시지)
- Thread 기능 활용 가능 (추후 피드백 수집용)

**전송 설정:**
- 사용자가 지정한 Slack 채널로 전송
- 전송 시점:
  - **즉시 전달 (1회성):** 수동 트리거 시 즉시 전송
  - **주기적 전달:** Cron 스케줄 설정 (예: 매일 오전 9시, 6시간마다 등)

### 2.4 웹 관리 인터페이스

**인증 시스템:**
- OAuth 2.0 (Slack 연동)
- Slack 로그인 → 자동으로 워크스페이스 정보 가져오기
- 채널 목록 자동 불러오기

**설정 화면 (Configuration Page):**
사용자가 설정 가능한 항목:
1. **대상 기간:** 몇 시간 이내 포스트 수집할지 (기본 24시간)
2. **선별 프롬프트:** AI가 참고할 관심사 (자연어)
3. **선별 개수:** 한 번에 전달받을 포스트 개수 (1-20개)
4. **전달 시점:**
   - 수동 실행 (즉시)
   - 주기적 실행 (Cron 표현식 또는 UI 선택)
6. **Slack 채널:** 메시지를 받을 채널 선택

**대시보드 (Dashboard Page):**
- **전달 이력:**
  - 날짜별 전송된 포스트 목록
  - 포스트 제목, 요약, 원본 링크
  - 전송 시간
- **심플한 UI:**
  - 과도한 통계/그래프 없이 이력 조회에 집중
  - 검색 및 날짜 필터 기능

**UI/UX 컨셉:**
- 깔끔하고 직관적인 디자인
- 모바일 반응형 (Tailwind CSS)
- Shadcn/UI 컴포넌트 활용

### 2.5 스케줄링 및 자동화

**주기적 실행:**
- Celery Beat + Redis를 활용한 백그라운드 작업
- 사용자 설정에 따라 Cron 스케줄 자동 생성

**자동 데이터 정리:**
- 48시간 경과한 포스트 자동 삭제 (매일 자정 실행)

**에러 처리:**
- Reddit API Rate Limit 초과 시 재시도 로직
- Slack API 실패 시 로그 저장 및 알림

## 3. 비기능 요구사항

### 3.1 성능
- Reddit 크롤링: 100개 포스트 기준 5분 이내
- AI 필터링: 포스트당 평균 2초 이내
- Slack 전송: 메시지당 1초 이내

### 3.2 확장성
- 서브레딧 추가 용이 (설정으로 확장 가능)
- 추후 Discord, 네이버 카페 등 다른 메신저 추가 가능한 구조

### 3.3 보안
- Slack OAuth Token 암호화 저장
- Reddit API Key 환경 변수 관리
- API 엔드포인트 인증 필수

### 3.4 모니터링
- 크롤링 성공/실패 로그
- AI API 호출 비용 추적
- Slack 전송 성공률 모니터링

## 4. 시스템 제약사항

### 4.1 외부 API 의존성
- Reddit API (PRAW)
- OpenAI API 또는 Anthropic API
- Slack API

### 4.2 비용 관리
- 무료 티어 최대 활용 (Supabase, Cloud Run 등)

### 4.3 Rate Limit
- Reddit: 60 requests/minute
- OpenAI: Tier별 RPM 제한 준수
- Slack: 1 message/second 권장

## 5. 개발 우선순위

### Phase 1: MVP (핵심 기능)
- [ ] Reddit API 연동 및 포스트 수집
- [ ] Supabase DB 스키마 설계 및 연결
- [ ] AI 프롬프트 기반 필터링
- [ ] Slack Webhook 기본 전송
- [ ] 웹: 간단한 설정 화면

### Phase 2: 자동화
- [ ] Celery 스케줄러 구현
- [ ] 48시간 자동 정리
- [ ] OAuth (Slack) 완전 구현
- [ ] 대시보드: 전달 이력 조회

### Phase 3: 고도화
- [ ] 관련 포스트 임베딩 유사도
- [ ] 영어 → 한국어 번역
- [ ] Slack Block Kit 고급 포맷

## 6. 향후 확장 가능성

### 6.1 피드백 루프 (Optional)
- Slack 이모지 반응 (👍/👎) 수집
- 피드백 데이터 기반 Few-Shot Learning
- AI 필터링 정확도 개선

### 6.2 멀티 플랫폼 지원
- 디시인사이드, 인벤 등 한국 커뮤니티 추가
- Twitter/X API 연동


